import{r as e,c as a,o as t,x as l,g as i,h as s,q as n,w as r,i as u,v as o,K as c,L as d,n as v,F as p,k as m,t as b,z as k,u as y,e as h}from"./vendor-vue.CBtg5bt5.js";import{u as g,a as f}from"./index.D8gGT4XT.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C={class:"orders-container"},w={class:"filter-area"},T={class:"row"},S={class:"col-md-8"},x={class:"filter-group"},R={class:"input-group search-box"},A={class:"col-md-4"},N={class:"filter-controls"},z={class:"status-filter"},M={class:"date-filter"},Y={key:0,class:"loading-container"},B={key:1,class:"no-results"},H={class:"no-results-content"},O={key:0},_={key:1},F={class:"no-results-actions"},I={key:2,class:"orders-list"},L={class:"table-responsive"},E={class:"table table-hover orders-table"},j=["onClick"],U={class:"order-number"},V={class:"customer-name"},G={class:"date-column"},K={class:"date-column"},W={class:"amount-column"},$={class:"status-column"},q={class:"btn-group"},J=["onClick"],P=["onClick"],Q={class:"btn-group"},X={class:"dropdown-menu"},Z=["onClick"],ee={key:0},ae=["onClick"],te={key:1},le=["onClick"],ie={class:"pagination-container"},se={class:"pagination-info"},ne={"aria-label":"Sipariş Sayfaları"},re={class:"pagination"},ue=["onClick"],oe=D({__name:"Orders",setup(D){const oe=y(),ce=g(),de=f(),ve=e(!1),pe=e([]),me=e(0),be=e(1),ke=e(10);e([5,10,20,50]);const ye=e({search:"",status:"",dateRange:"all",startDate:null,endDate:null}),he=e({key:"createdAt",direction:"desc"});e(!1);const ge=e(!1),fe=e(""),De=e(""),Ce=e(""),we=e(""),Te=e(null),Se=a((()=>ce.hasRole(["admin","manager"]))),xe=a((()=>""!==ye.value.search||""!==ye.value.status||"all"!==ye.value.dateRange)),Re=a((()=>Math.ceil(me.value/ke.value)||1)),Ae=a((()=>(be.value-1)*ke.value)),Ne=a((()=>Math.min(Ae.value+ke.value,me.value))),ze=a((()=>{const e=[],a=be.value-2,t=be.value+2+1;for(let l=1;l<=Re.value;l++)(1===l||l===Re.value||l>=a&&l<t)&&e.push(l);return e})),Me=a((()=>[...pe.value].sort(((e,a)=>{let t=e[he.value.key],l=a[he.value.key];return"string"==typeof t&&"string"==typeof l&&(t=t.toLowerCase(),l=l.toLowerCase()),t<l?"asc"===he.value.direction?-1:1:t>l?"asc"===he.value.direction?1:-1:0}))));t((async()=>{await He()})),l(be,(()=>{He()}));let Ye=null;function Be(){Ye&&clearTimeout(Ye),Ye=setTimeout((()=>{Oe()}),300)}async function He(){ve.value=!0;try{const e={page:be.value,limit:ke.value,sort:`${he.value.key},${he.value.direction}`};if(ye.value.search&&(e.search=ye.value.search),ye.value.status&&(e.status=ye.value.status),ye.value.startDate&&ye.value.endDate)e.startDate=ye.value.startDate,e.endDate=ye.value.endDate;else if("all"!==ye.value.dateRange){const a=function(e){const a=new Date,t=new Date,l=new Date;switch(e){case"today":t.setHours(0,0,0,0),l.setHours(23,59,59,999);break;case"thisWeek":const e=a.getDay()||7;t.setDate(a.getDate()-e+1),t.setHours(0,0,0,0),l.setDate(t.getDate()+6),l.setHours(23,59,59,999);break;case"thisMonth":t.setDate(1),t.setHours(0,0,0,0),l.setMonth(a.getMonth()+1,0),l.setHours(23,59,59,999);break;default:return{startDate:null,endDate:null}}return{startDate:t.toISOString(),endDate:l.toISOString()}}(ye.value.dateRange);e.startDate=a.startDate,e.endDate=a.endDate}pe.value=[{id:"1",orderNumber:"ORD-2023-001",customer:"METS Enerji Ltd. Şti.",createdAt:"2023-04-15T10:30:00",deliveryDate:"2023-05-15T00:00:00",amount:125e3,status:"tamamlandı"},{id:"2",orderNumber:"ORD-2023-002",customer:"Teknik Yapı A.Ş.",createdAt:"2023-04-18T14:20:00",deliveryDate:"2023-05-20T00:00:00",amount:86500,status:"işlemde"},{id:"3",orderNumber:"ORD-2023-003",customer:"Güç Sistemleri Ltd.",createdAt:"2023-04-20T09:15:00",deliveryDate:"2023-05-25T00:00:00",amount:42800,status:"beklemede"}],me.value=pe.value.length}catch(e){de.showNotification({type:"error",message:"Sipariş listesi yüklenirken bir hata oluştu."})}finally{ve.value=!1}}function Oe(){be.value=1,He()}function _e(){ye.value={search:"",status:"",dateRange:"all",startDate:null,endDate:null},Oe()}function Fe(e){he.value.key===e?he.value.direction="asc"===he.value.direction?"desc":"asc":(he.value.key=e,he.value.direction="asc"),be.value=1,He()}function Ie(e){return he.value.key===e?"asc"===he.value.direction?"bi bi-arrow-up":"bi bi-arrow-down":""}function Le(e){switch(e.toLowerCase()){case"tamamlandı":return"status-completed";case"işlemde":return"status-in-progress";case"beklemede":return"status-pending";case"iptal":return"status-canceled";default:return""}}function Ee(e){if(!e)return"-";const a=new Date(e);return new Intl.DateTimeFormat("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(a)}function je(e){oe.push({name:"OrderDetail",params:{id:e}})}function Ue(){oe.push({name:"OrderCreate"})}function Ve(){He()}function Ge(e){be.value=e}return(e,a)=>(h(),i("div",C,[s("div",{class:"page-header"},[a[16]||(a[16]=s("h1",null,"Siparişler",-1)),s("div",{class:"header-actions"},[s("button",{class:"btn btn-primary",onClick:Ue},a[14]||(a[14]=[s("i",{class:"bi bi-plus-circle"},null,-1),n(" Yeni Sipariş ")])),s("button",{class:"btn btn-outline-secondary",onClick:Ve},a[15]||(a[15]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),n(" Yenile ")]))])]),s("div",w,[s("div",T,[s("div",S,[s("div",x,[s("div",R,[a[18]||(a[18]=s("span",{class:"input-group-text"},[s("i",{class:"bi bi-search"})],-1)),r(s("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>ye.value.search=e),placeholder:"Sipariş no, müşteri adı veya ürün ara...",onInput:Be},null,544),[[o,ye.value.search]]),xe.value?(h(),i("button",{key:0,class:"btn btn-outline-secondary",type:"button",onClick:_e},a[17]||(a[17]=[s("i",{class:"bi bi-x-lg"},null,-1)]))):u("",!0)])])]),s("div",A,[s("div",N,[s("div",z,[r(s("select",{class:"form-select","onUpdate:modelValue":a[1]||(a[1]=e=>ye.value.status=e),onChange:Oe},a[19]||(a[19]=[d('<option value="" data-v-2e89172c>Tüm Durumlar</option><option value="beklemede" data-v-2e89172c>Beklemede</option><option value="işlemde" data-v-2e89172c>İşlemde</option><option value="tamamlandı" data-v-2e89172c>Tamamlandı</option><option value="iptal" data-v-2e89172c>İptal</option>',5)]),544),[[c,ye.value.status]])]),s("div",M,[r(s("select",{class:"form-select","onUpdate:modelValue":a[2]||(a[2]=e=>ye.value.dateRange=e),onChange:Oe},a[20]||(a[20]=[d('<option value="all" data-v-2e89172c>Tüm Tarihler</option><option value="today" data-v-2e89172c>Bugün</option><option value="thisWeek" data-v-2e89172c>Bu Hafta</option><option value="thisMonth" data-v-2e89172c>Bu Ay</option><option value="custom" data-v-2e89172c>Özel Tarih</option>',5)]),544),[[c,ye.value.dateRange]])])])])])]),ve.value?(h(),i("div",Y,a[21]||(a[21]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Yükleniyor...")],-1)]))):0===pe.value.length?(h(),i("div",B,[s("div",H,[a[24]||(a[24]=s("i",{class:"bi bi-inbox-fill"},null,-1)),a[25]||(a[25]=s("h3",null,"Sipariş Bulunamadı",-1)),xe.value?(h(),i("p",O,"Filtreleri değiştirerek tekrar deneyin veya yeni bir sipariş oluşturun.")):(h(),i("p",_,'Henüz hiç sipariş oluşturulmamış. Yeni sipariş oluşturmak için "Yeni Sipariş" butonunu kullanın.')),s("div",F,[s("button",{class:"btn btn-primary",onClick:Ue},a[22]||(a[22]=[s("i",{class:"bi bi-plus-circle"},null,-1),n(" Yeni Sipariş ")])),xe.value?(h(),i("button",{key:0,class:"btn btn-outline-secondary",onClick:_e},a[23]||(a[23]=[s("i",{class:"bi bi-funnel"},null,-1),n(" Filtreleri Temizle ")]))):u("",!0)])])])):(h(),i("div",I,[s("div",L,[s("table",E,[s("thead",null,[s("tr",null,[s("th",{onClick:a[3]||(a[3]=e=>Fe("orderNumber")),class:v({"sorting-active":"orderNumber"===he.value.key})},[a[26]||(a[26]=n(" Sipariş No ")),"orderNumber"===he.value.key?(h(),i("i",{key:0,class:v(Ie("orderNumber"))},null,2)):u("",!0)],2),s("th",{onClick:a[4]||(a[4]=e=>Fe("customer")),class:v({"sorting-active":"customer"===he.value.key})},[a[27]||(a[27]=n(" Müşteri ")),"customer"===he.value.key?(h(),i("i",{key:0,class:v(Ie("customer"))},null,2)):u("",!0)],2),s("th",{onClick:a[5]||(a[5]=e=>Fe("createdAt")),class:v({"sorting-active":"createdAt"===he.value.key})},[a[28]||(a[28]=n(" Sipariş Tarihi ")),"createdAt"===he.value.key?(h(),i("i",{key:0,class:v(Ie("createdAt"))},null,2)):u("",!0)],2),s("th",{onClick:a[6]||(a[6]=e=>Fe("deliveryDate")),class:v({"sorting-active":"deliveryDate"===he.value.key})},[a[29]||(a[29]=n(" Teslim Tarihi ")),"deliveryDate"===he.value.key?(h(),i("i",{key:0,class:v(Ie("deliveryDate"))},null,2)):u("",!0)],2),s("th",{onClick:a[7]||(a[7]=e=>Fe("amount")),class:v({"sorting-active":"amount"===he.value.key})},[a[30]||(a[30]=n(" Toplam Tutar ")),"amount"===he.value.key?(h(),i("i",{key:0,class:v(Ie("amount"))},null,2)):u("",!0)],2),s("th",{onClick:a[8]||(a[8]=e=>Fe("status")),class:v({"sorting-active":"status"===he.value.key})},[a[31]||(a[31]=n(" Durum ")),"status"===he.value.key?(h(),i("i",{key:0,class:v(Ie("status"))},null,2)):u("",!0)],2),a[32]||(a[32]=s("th",null,"İşlemler",-1))])]),s("tbody",null,[(h(!0),i(p,null,m(Me.value,(e=>{return h(),i("tr",{key:e.id,onClick:a=>je(e.id)},[s("td",U,b(e.orderNumber),1),s("td",V,b(e.customer),1),s("td",G,b(Ee(e.createdAt)),1),s("td",K,b(Ee(e.deliveryDate)),1),s("td",W,b((t=e.amount,new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2}).format(t))),1),s("td",$,[s("span",{class:v(["status-badge",Le(e.status)])},b(e.status),3)]),s("td",{class:"actions-column",onClick:a[9]||(a[9]=k((()=>{}),["stop"]))},[s("div",q,[s("button",{class:"btn btn-sm btn-outline-primary",onClick:a=>je(e.id),title:"Detay Görüntüle"},a[33]||(a[33]=[s("i",{class:"bi bi-eye"},null,-1)]),8,J),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:a=>{e.id},title:"Yazdır"},a[34]||(a[34]=[s("i",{class:"bi bi-printer"},null,-1)]),8,P),s("div",Q,[a[38]||(a[38]=s("button",{type:"button",class:"btn btn-sm btn-outline-secondary dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},[s("i",{class:"bi bi-three-dots-vertical"})],-1)),s("ul",X,[s("li",null,[s("a",{class:"dropdown-item",href:"#",onClick:k((a=>{e.id}),["prevent"])},a[35]||(a[35]=[s("i",{class:"bi bi-copy"},null,-1),n(" Kopyala ")]),8,Z)]),"iptal"!==e.status?(h(),i("li",ee,[s("a",{class:"dropdown-item text-danger",href:"#",onClick:k((a=>{return t=e.id,fe.value="Siparişi İptal Et",De.value="Bu siparişi iptal etmek istediğinizden emin misiniz?",Ce.value="Siparişi İptal Et",we.value="cancel",Te.value=t,void(ge.value=!0);var t}),["prevent"])},a[36]||(a[36]=[s("i",{class:"bi bi-x-circle"},null,-1),n(" İptal Et ")]),8,ae)])):u("",!0),Se.value?(h(),i("li",te,[s("a",{class:"dropdown-item text-danger",href:"#",onClick:k((a=>{return t=e.id,fe.value="Siparişi Sil",De.value="Bu siparişi silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!",Ce.value="Siparişi Sil",we.value="delete",Te.value=t,void(ge.value=!0);var t}),["prevent"])},a[37]||(a[37]=[s("i",{class:"bi bi-trash"},null,-1),n(" Sil ")]),8,le)])):u("",!0)])])])])],8,j);var t})),128))])])]),s("div",ie,[s("div",se," Toplam "+b(me.value)+" sipariş içinden "+b(Ae.value+1)+"-"+b(Math.min(Ne.value,me.value))+" arası gösteriliyor ",1),s("nav",ne,[s("ul",re,[s("li",{class:v(["page-item",{disabled:1===be.value}])},[s("a",{class:"page-link",href:"#",onClick:a[10]||(a[10]=k((e=>Ge(1)),["prevent"]))},a[39]||(a[39]=[s("i",{class:"bi bi-chevron-double-left"},null,-1)]))],2),s("li",{class:v(["page-item",{disabled:1===be.value}])},[s("a",{class:"page-link",href:"#",onClick:a[11]||(a[11]=k((e=>Ge(be.value-1)),["prevent"]))},a[40]||(a[40]=[s("i",{class:"bi bi-chevron-left"},null,-1)]))],2),(h(!0),i(p,null,m(ze.value,(e=>(h(),i("li",{key:e,class:v(["page-item",{active:e===be.value}])},[s("a",{class:"page-link",href:"#",onClick:k((a=>Ge(e)),["prevent"])},b(e),9,ue)],2)))),128)),s("li",{class:v(["page-item",{disabled:be.value===Re.value}])},[s("a",{class:"page-link",href:"#",onClick:a[12]||(a[12]=k((e=>Ge(be.value+1)),["prevent"]))},a[41]||(a[41]=[s("i",{class:"bi bi-chevron-right"},null,-1)]))],2),s("li",{class:v(["page-item",{disabled:be.value===Re.value}])},[s("a",{class:"page-link",href:"#",onClick:a[13]||(a[13]=k((e=>Ge(Re.value)),["prevent"]))},a[42]||(a[42]=[s("i",{class:"bi bi-chevron-double-right"},null,-1)]))],2)])])])]))]))}},[["__scopeId","data-v-2e89172c"]]);export{oe as default};
